import{j as e,c as x,m as H}from"./ui-E8jIx32d.js";import{r as p}from"./vendor-08mqACR8.js";import{b as _,u as J,d as U}from"./data-CNpY1-rC.js";import{S as V,I as W,z as g}from"./index-Csr_6NQa.js";import{i as A}from"./interviewService-CFGVipFL.js";import{D as G,A as q}from"./DashboardLayout-Crwp17Vt.js";import{B as y}from"./Button-DkVvCag_.js";import"./Input-Bbjou70d.js";import"./Textarea-Da6oJh8a.js";import{C as b}from"./Card-Kk9NAdVM.js";import{B as E}from"./Badge-BMjbNvha.js";import{M as X}from"./Modal-DPRplyTw.js";import{F as z}from"./XCircleIcon-DXZ4M08a.js";import{F as B}from"./ExclamationTriangleIcon-CwzaXQnI.js";import{F as v}from"./CheckCircleIcon-BIxcTuyz.js";import{F as Y}from"./InformationCircleIcon-BzNmsCGV.js";import{F as Z}from"./DocumentTextIcon-CLIC1k8p.js";import{F as ee}from"./UserIcon-ACflAg1t.js";import{F as se}from"./ClockIcon-sUFCzahK.js";import{F as te}from"./UsersIcon-hudjBy-f.js";import"./useAuth-kxZUTXHI.js";import"./XMarkIcon-B-SQiyPX.js";import"./BuildingOfficeIcon-m0Wh3_We.js";const ae=({variant:u="info",title:t,children:h,className:j,onClose:l})=>{const a={info:{bg:"bg-blue-50 border-blue-200",text:"text-blue-800",icon:Y},success:{bg:"bg-green-50 border-green-200",text:"text-green-800",icon:v},warning:{bg:"bg-yellow-50 border-yellow-200",text:"text-yellow-800",icon:B},error:{bg:"bg-red-50 border-red-200",text:"text-red-800",icon:z}},{bg:d,text:i,icon:f}=a[u];return e.jsx("div",{className:x("rounded-lg border p-4",d,j),children:e.jsxs("div",{className:"flex",children:[e.jsx(f,{className:x("h-5 w-5 flex-shrink-0",i)}),e.jsxs("div",{className:"ml-3 flex-1",children:[t&&e.jsx("h3",{className:x("text-sm font-medium",i),children:t}),e.jsx("div",{className:x("text-sm",i,t&&"mt-1"),children:h})]}),l&&e.jsxs("button",{type:"button",className:x("ml-auto -mx-1.5 -my-1.5 p-1.5 rounded-lg hover:bg-black/5",i),onClick:l,children:[e.jsx("span",{className:"sr-only",children:"Dismiss"}),e.jsx(z,{className:"h-5 w-5"})]})]})})},Fe=()=>{var S,k,C,F,R,D;const u=_(),[t,h]=p.useState(null),[j,l]=p.useState(!1),[a,d]=p.useState({date:"",time:"",duration:60}),{data:i,isLoading:f,error:P}=J({queryKey:["available-interview-requests"],queryFn:()=>A.getAvailableRequests()}),N=U({mutationFn:({id:s,data:n})=>A.claimInterview(s,n),onSuccess:()=>{g.success("Interview claimed successfully! The job seeker has been notified."),l(!1),h(null),u.invalidateQueries({queryKey:["available-interview-requests"]}),u.invalidateQueries({queryKey:["my-interviews"]})},onError:s=>{g.error(s.message||"Failed to claim interview")}}),Q=()=>{if(!t||!a.date||!a.time){g.error("Please select a date and time");return}const s=new Date(`${a.date}T${a.time}`);if(s<=new Date){g.error("Please select a future date and time");return}N.mutate({id:t._id,data:{scheduledAt:s.toISOString(),duration:a.duration}})},K=s=>{h(s),d({date:"",time:"",duration:s.preferredDuration||60}),l(!0)},L=s=>{const n=new Date(s),m=new Date().getTime()-n.getTime(),r=Math.floor(m/(1e3*60*60)),c=Math.floor(r/24);return c>0?`${c} day${c>1?"s":""} ago`:r>0?`${r} hour${r>1?"s":""} ago`:"Just now"},O=s=>{if(!s)return null;const n=new Date(s),o=new Date,m=n.getTime()-o.getTime(),r=Math.ceil(m/(1e3*60*60*24));return r<=1?{text:"Expires soon",urgent:!0}:{text:`${r} days left`,urgent:!1}},w=(i==null?void 0:i.data)||[];return e.jsx(G,{children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Available Interview Requests"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"View and claim interview requests matching your expertise"})]}),e.jsx(b,{className:"mb-8 bg-green-50 border-green-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-green-100 rounded-lg",children:e.jsx(v,{className:"h-6 w-6 text-green-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-green-900",children:"How to Claim Interviews"}),e.jsx("p",{className:"text-green-700 mt-1",children:"Browse requests that match your expertise. When you claim a request, you'll set the interview time based on your availability. The job seeker will be automatically notified."})]})]})}),f&&e.jsx("div",{className:"flex justify-center py-12",children:e.jsx(V,{size:"lg"})}),P&&e.jsx(ae,{variant:"error",children:"Failed to load interview requests. Please try again."}),!f&&w.length===0&&e.jsxs(b,{className:"text-center py-12",children:[e.jsx(Z,{className:"h-12 w-12 mx-auto text-gray-400"}),e.jsx("h3",{className:"mt-4 text-lg font-medium text-gray-900",children:"No Requests Available"}),e.jsx("p",{className:"mt-2 text-gray-600",children:"There are no interview requests matching your expertise at the moment. Check back later!"})]}),e.jsx("div",{className:"space-y-4",children:w.map((s,n)=>{var m,r,c,$,I,T;const o=O(s.expiresAt);return e.jsx(H.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:n*.05},children:e.jsx(b,{className:"hover:shadow-lg transition-shadow",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex items-start gap-4 flex-1",children:[e.jsx(q,{src:(m=s.jobSeeker)==null?void 0:m.avatar,name:`${(r=s.jobSeeker)==null?void 0:r.firstName} ${(c=s.jobSeeker)==null?void 0:c.lastName}`,size:"lg"}),e.jsxs("div",{className:"flex-1 min-w-0",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:[($=s.jobSeeker)==null?void 0:$.firstName," ",(I=s.jobSeeker)==null?void 0:I.lastName]}),e.jsx(E,{variant:"info",children:W.REQUESTED===s.status?"New Request":s.status})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[e.jsx(ee,{className:"inline h-4 w-4 mr-1"}),"Requested ",L(s.createdAt)]}),e.jsxs("div",{className:"mt-3",children:[e.jsx("p",{className:"text-sm text-gray-600 mb-2",children:"Requested Skills:"}),e.jsx("div",{className:"flex flex-wrap gap-2",children:(T=s.requestedSkills)==null?void 0:T.map(M=>e.jsx(E,{variant:"primary",children:M},M))})]}),e.jsxs("div",{className:"mt-3 flex items-center gap-4 text-sm text-gray-600",children:[e.jsxs("span",{className:"flex items-center",children:[e.jsx(se,{className:"h-4 w-4 mr-1"}),s.preferredDuration||60," min preferred"]}),o&&e.jsxs("span",{className:`flex items-center ${o.urgent?"text-orange-600":""}`,children:[o.urgent&&e.jsx(B,{className:"h-4 w-4 mr-1"}),o.text]})]}),s.notes&&e.jsx("div",{className:"mt-3 p-3 bg-gray-50 rounded-lg",children:e.jsxs("p",{className:"text-sm text-gray-700",children:[e.jsx("strong",{children:"Notes:"})," ",s.notes]})})]})]}),e.jsx("div",{className:"flex items-center",children:e.jsxs(y,{onClick:()=>K(s),children:[e.jsx(te,{className:"h-5 w-5 mr-2"}),"Claim & Schedule"]})})]})})},s._id)})}),e.jsx(X,{isOpen:j,onClose:()=>l(!1),title:"Claim Interview Request",size:"md",children:t&&e.jsxs("div",{className:"space-y-6",children:[e.jsx("div",{className:"p-4 bg-gray-50 rounded-lg",children:e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(q,{src:(S=t.jobSeeker)==null?void 0:S.avatar,name:`${(k=t.jobSeeker)==null?void 0:k.firstName} ${(C=t.jobSeeker)==null?void 0:C.lastName}`,size:"md"}),e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[(F=t.jobSeeker)==null?void 0:F.firstName," ",(R=t.jobSeeker)==null?void 0:R.lastName]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Skills: ",(D=t.requestedSkills)==null?void 0:D.join(", ")]})]})]})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-medium text-gray-900 mb-4",children:"Set Interview Time"}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Date *"}),e.jsx("input",{type:"date",value:a.date,onChange:s=>d({...a,date:s.target.value}),min:new Date().toISOString().split("T")[0],className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Time *"}),e.jsx("input",{type:"time",value:a.time,onChange:s=>d({...a,time:s.target.value}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]})]})]}),e.jsxs("div",{children:[e.jsx("label",{className:"block text-sm font-medium text-gray-700 mb-1",children:"Duration"}),e.jsxs("select",{value:a.duration,onChange:s=>d({...a,duration:parseInt(s.target.value)}),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500",children:[e.jsx("option",{value:30,children:"30 minutes"}),e.jsx("option",{value:45,children:"45 minutes"}),e.jsx("option",{value:60,children:"60 minutes"}),e.jsx("option",{value:90,children:"90 minutes"})]}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:["Candidate preferred: ",t.preferredDuration||60," minutes"]})]}),t.notes&&e.jsx("div",{className:"p-3 bg-yellow-50 border border-yellow-200 rounded-lg",children:e.jsxs("p",{className:"text-sm text-yellow-800",children:[e.jsx("strong",{children:"Candidate's Notes:"})," ",t.notes]})}),e.jsxs("div",{className:"flex justify-end gap-3 pt-4 border-t",children:[e.jsx(y,{variant:"outline",onClick:()=>l(!1),children:"Cancel"}),e.jsxs(y,{onClick:Q,isLoading:N.isPending,disabled:!a.date||!a.time,children:[e.jsx(v,{className:"h-5 w-5 mr-2"}),"Confirm & Claim"]})]})]})})]})})};export{Fe as default};
