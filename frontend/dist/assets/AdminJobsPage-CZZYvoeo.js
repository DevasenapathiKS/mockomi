import{j as e,m as z}from"./ui-E8jIx32d.js";import{r as c}from"./vendor-08mqACR8.js";import{b as A,u as P,d as b}from"./data-CNpY1-rC.js";import{S as $,z as h,h as g}from"./index-Cjn7xYNH.js";import{D as C}from"./DashboardLayout-C3XsTHZl.js";import{B as i}from"./Button-DkVvCag_.js";import{I as L}from"./Input-Bbjou70d.js";import"./Textarea-Da6oJh8a.js";import{C as F}from"./Card-Kk9NAdVM.js";import{B as o}from"./Badge-BMjbNvha.js";import{M as y}from"./Modal-DPRplyTw.js";import{F as M}from"./MagnifyingGlassIcon-DUoGsubn.js";import{F as D}from"./XMarkIcon-B-SQiyPX.js";import{F as q}from"./BuildingOfficeIcon-m0Wh3_We.js";import{F as B}from"./MapPinIcon-CHXOjtSM.js";import{a as I}from"./UsersIcon-hudjBy-f.js";import{F as E}from"./EyeIcon-Bn7EARGA.js";import{F as Q}from"./CheckCircleIcon-BIxcTuyz.js";import{F as _}from"./XCircleIcon-DXZ4M08a.js";import{F as K}from"./TrashIcon-DbF6K8lY.js";import"./useAuth-cQdBU6Dg.js";import"./UserIcon-ACflAg1t.js";const pe=()=>{const f=A(),[d,S]=c.useState(""),[m,k]=c.useState("all"),[r,v]=c.useState(1),[a,x]=c.useState(null),[j,t]=c.useState(null),{data:n,isLoading:R}=P({queryKey:["admin-jobs",{search:d,statusFilter:m,page:r}],queryFn:async()=>{const s=new URLSearchParams;return d&&s.append("search",d),m!=="all"&&s.append("status",m),s.append("page",r.toString()),s.append("limit","20"),(await g.get(`/admin/jobs?${s.toString()}`)).data}}),p=b({mutationFn:async({jobId:s,status:l})=>(await g.patch(`/admin/jobs/${s}/status`,{status:l})).data,onSuccess:()=>{f.invalidateQueries({queryKey:["admin-jobs"]}),h.success("Job status updated"),t(null)},onError:()=>{h.error("Failed to update job status")}}),N=b({mutationFn:async s=>(await g.delete(`/admin/jobs/${s}`)).data,onSuccess:()=>{f.invalidateQueries({queryKey:["admin-jobs"]}),h.success("Job deleted"),t(null)},onError:()=>{h.error("Failed to delete job")}}),w=(n==null?void 0:n.jobs)||[],u=(n==null?void 0:n.pagination)||{total:0,pages:1},J=s=>{switch(s){case"active":return e.jsx(o,{variant:"success",children:"Active"});case"paused":return e.jsx(o,{variant:"warning",children:"Paused"});case"closed":return e.jsx(o,{variant:"gray",children:"Closed"});case"pending":return e.jsx(o,{variant:"info",children:"Pending Review"});default:return e.jsx(o,{children:s})}};return R?e.jsx(C,{children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx($,{size:"lg"})})}):e.jsx(C,{children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Manage Jobs"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[u.total," total job postings"]})]}),e.jsx(F,{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(M,{className:"h-5 w-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx(L,{placeholder:"Search jobs or companies...",value:d,onChange:s=>S(s.target.value),className:"pl-10"})]}),e.jsxs("select",{value:m,onChange:s=>k(s.target.value),className:"w-48 px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"paused",children:"Paused"}),e.jsx("option",{value:"pending",children:"Pending Review"}),e.jsx("option",{value:"closed",children:"Closed"})]})]})}),e.jsxs(F,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Job"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Company"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Location"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Applications"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Posted"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:w.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:7,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx(D,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"No jobs found"})]})}):w.map((s,l)=>e.jsxs(z.tr,{initial:{opacity:0},animate:{opacity:1},transition:{delay:l*.03},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{children:[e.jsx("p",{className:"font-medium text-gray-900",children:s.title}),e.jsx("p",{className:"text-sm text-gray-500 capitalize",children:s.type})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[s.company.logo?e.jsx("img",{src:s.company.logo,alt:s.company.name,className:"h-8 w-8 rounded-full mr-3"}):e.jsx("div",{className:"h-8 w-8 rounded-full bg-gray-200 flex items-center justify-center mr-3",children:e.jsx(q,{className:"h-4 w-4 text-gray-500"})}),e.jsx("span",{className:"text-gray-900",children:s.company.name})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(B,{className:"h-4 w-4 mr-1"}),s.location]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center text-gray-600",children:[e.jsx(I,{className:"h-4 w-4 mr-1"}),s.applications]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:J(s.status)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(i,{variant:"outline",size:"sm",onClick:()=>{x(s),t("view")},children:e.jsx(E,{className:"h-4 w-4"})}),s.status==="pending"&&e.jsxs(e.Fragment,{children:[e.jsx(i,{variant:"outline",size:"sm",className:"text-green-600",onClick:()=>{x(s),t("approve")},children:e.jsx(Q,{className:"h-4 w-4"})}),e.jsx(i,{variant:"outline",size:"sm",className:"text-red-600",onClick:()=>{x(s),t("reject")},children:e.jsx(_,{className:"h-4 w-4"})})]}),e.jsx(i,{variant:"outline",size:"sm",className:"text-red-600",onClick:()=>{x(s),t("delete")},children:e.jsx(K,{className:"h-4 w-4"})})]})})]},s._id))})]})}),u.pages>1&&e.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[e.jsx(i,{variant:"outline",size:"sm",disabled:r===1,onClick:()=>v(r-1),children:"Previous"}),e.jsxs("span",{className:"flex items-center px-4 text-sm text-gray-600",children:["Page ",r," of ",u.pages]}),e.jsx(i,{variant:"outline",size:"sm",disabled:r===u.pages,onClick:()=>v(r+1),children:"Next"})]})]}),e.jsx(y,{isOpen:j==="approve"&&!!a,onClose:()=>t(null),title:"Approve Job",size:"sm",children:a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-600",children:['Are you sure you want to approve "',a.title,'" posted by ',a.company.name,"? It will be visible to all job seekers."]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(i,{variant:"outline",onClick:()=>t(null),children:"Cancel"}),e.jsx(i,{onClick:()=>p.mutate({jobId:a._id,status:"active"}),isLoading:p.isPending,children:"Approve Job"})]})]})}),e.jsx(y,{isOpen:j==="reject"&&!!a,onClose:()=>t(null),title:"Reject Job",size:"sm",children:a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-600",children:['Are you sure you want to reject "',a.title,'"? The employer will be notified.']}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(i,{variant:"outline",onClick:()=>t(null),children:"Cancel"}),e.jsx(i,{className:"bg-red-600 hover:bg-red-700",onClick:()=>p.mutate({jobId:a._id,status:"closed"}),isLoading:p.isPending,children:"Reject Job"})]})]})}),e.jsx(y,{isOpen:j==="delete"&&!!a,onClose:()=>t(null),title:"Delete Job",size:"sm",children:a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-600",children:['Are you sure you want to permanently delete "',a.title,'"? This will also delete all associated applications.']}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(i,{variant:"outline",onClick:()=>t(null),children:"Cancel"}),e.jsx(i,{className:"bg-red-600 hover:bg-red-700",onClick:()=>N.mutate(a._id),isLoading:N.isPending,children:"Delete Job"})]})]})})]})})};export{pe as default};
