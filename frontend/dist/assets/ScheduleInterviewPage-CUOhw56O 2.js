import{j as e,m as P}from"./ui-CYsdiTaZ.js";import{e as K,r as p}from"./vendor-08mqACR8.js";import{a as O,u as Q,b as $}from"./query-XD-553fC.js";import{h as I,i as q,u as B,z as d}from"./index-CtB2e-Jf.js";import{i as z}from"./interviewService-B10jMYsL.js";import{D as Y}from"./DashboardLayout-p1chFnBS.js";import{B as G}from"./Button-qtzxgz-Z.js";import"./Input-BBy5sVcg.js";import"./Textarea-BjLH9yoL.js";import{C as y}from"./Card-L60jO2Bd.js";import{F as T}from"./InformationCircleIcon-BzNmsCGV.js";import{F as U}from"./CurrencyRupeeIcon-qiBkUxPz.js";import{F as H}from"./ClockIcon-sUFCzahK.js";import{F as J}from"./UsersIcon-hudjBy-f.js";import{F as V}from"./CheckCircleIcon-BIxcTuyz.js";import"./useAuth-C5MDDvFB.js";import"./XMarkIcon-B-SQiyPX.js";import"./UserIcon-ACflAg1t.js";import"./BuildingOfficeIcon-m0Wh3_We.js";const F={createOrder:async u=>{try{return(await I.post("/payments/create-order",u)).data.data}catch(i){throw new Error(q(i))}},verifyPayment:async u=>{try{return(await I.post("/payments/verify",u)).data.data}catch(i){throw new Error(q(i))}}},W=["JavaScript","TypeScript","React","Angular","Vue.js","Node.js","Python","Java","C++","Go","Rust","Ruby","System Design","Data Structures","Algorithms","Database Design","AWS","Azure","GCP","Docker","Kubernetes","DevOps","Machine Learning","Data Science","AI/ML","Frontend","Backend","Full Stack","Mobile Development","REST API","GraphQL","Microservices","SQL","MongoDB","PostgreSQL","Redis","Behavioral","HR Interview","Leadership"],X=[{value:30,label:"30 minutes"},{value:45,label:"45 minutes"},{value:60,label:"60 minutes (Recommended)"},{value:90,label:"90 minutes"}],fe=()=>{var k;const u=K(),i=O(),{user:s}=B(),[t,f]=p.useState([]),[x,A]=p.useState(60),[w,D]=p.useState(""),[h,_]=p.useState(""),[v,b]=p.useState(!1),j=W.filter(r=>r.toLowerCase().includes(h.toLowerCase())&&!t.includes(r)),n=Q({queryKey:["interview-payment-check"],queryFn:()=>z.checkPaymentRequirement()}),N=$({mutationFn:r=>z.createInterviewRequest({requestedSkills:t,preferredDuration:x,notes:w||void 0,paymentId:r==null?void 0:r.paymentId}),onSuccess:()=>{d.success("Interview request submitted! You will be notified when an interviewer accepts."),i.invalidateQueries({queryKey:["my-interviews"]}),i.invalidateQueries({queryKey:["my-interview-requests"]}),u("/dashboard/interviews")},onError:r=>{d.error(r.message||"Failed to submit interview request")}}),C=()=>new Promise((r,a)=>{if(window.Razorpay){r();return}const c=document.createElement("script");c.src="https://checkout.razorpay.com/v1/checkout.js",c.onload=()=>r(),c.onerror=()=>a(new Error("Failed to load Razorpay SDK")),document.body.appendChild(c)}),E=async()=>{const r=n.data,a=Math.max(1e4,Math.round(((r==null?void 0:r.pricePerInterview)??100)*100)),c="rzp_test_RxlUrYIiGrG6kN",o=await F.createOrder({amount:a,notes:{reason:"mock_interview_request"}});return await C(),new Promise((M,g)=>{if(!window.Razorpay){g(new Error("Razorpay SDK not available"));return}const R=new window.Razorpay({key:c,amount:o.amount,currency:o.currency,name:"Mockomi",description:"Mock interview booking",order_id:o.orderId,handler:async l=>{try{const m=await F.verifyPayment({razorpay_order_id:l.razorpay_order_id,razorpay_payment_id:l.razorpay_payment_id,razorpay_signature:l.razorpay_signature});M(m._id)}catch(m){g(m)}},prefill:{name:`${(s==null?void 0:s.firstName)??""} ${(s==null?void 0:s.lastName)??""}`.trim(),email:(s==null?void 0:s.email)||""},notes:o!=null&&o.paymentId?{paymentId:o.paymentId}:void 0,theme:{color:"#0ea5e9"}});R.on("payment.failed",l=>{var m;g(new Error(((m=l==null?void 0:l.error)==null?void 0:m.description)||"Payment failed"))}),R.open()})},S=r=>{t.includes(r)?f(t.filter(a=>a!==r)):f([...t,r])},L=async()=>{if(t.length===0){d.error("Please select at least one skill for your interview");return}try{let r;const a=(await n.refetch()).data;if(!a){d.error("Unable to check payment eligibility. Please try again.");return}a.required&&(b(!0),r=await E(),d.success("Payment successful. Creating interview request...")),await N.mutateAsync({paymentId:r})}catch(r){d.error((r==null?void 0:r.message)||"Failed to submit interview request")}finally{b(!1)}};return e.jsx(Y,{children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Request Mock Interview"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Select the skills you want to be interviewed on. An expert interviewer will pick up your request."})]}),e.jsx(y,{className:"mb-8 bg-blue-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(T,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:"How It Works"}),e.jsxs("ol",{className:"list-decimal list-inside text-blue-700 mt-2 space-y-1",children:[e.jsx("li",{children:"Select the skills/topics you want to practice"}),e.jsx("li",{children:"Choose your preferred interview duration"}),e.jsx("li",{children:"Submit your request"}),e.jsx("li",{children:"An expert interviewer matching your skills will claim your request"}),e.jsx("li",{children:"You'll receive a notification with the scheduled time"})]})]})]})}),e.jsx(y,{className:"mb-8 bg-primary-50 border-primary-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-primary-100 rounded-lg",children:e.jsx(U,{className:"h-6 w-6 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-primary-900",children:"Pricing Information"}),e.jsxs("p",{className:"text-primary-700 mt-1",children:["Your first 2 mock interviews are ",e.jsx("strong",{children:"FREE"}),"! After that, each interview costs just ₹",((k=n.data)==null?void 0:k.pricePerInterview)??100,"."]}),n.data&&e.jsxs("p",{className:"text-sm text-primary-700 mt-2",children:["Free interviews left: ",n.data.freeInterviewsRemaining??0,". Payment required: ",n.data.required?"Yes":"No","."]})]})]})}),e.jsxs(y,{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Select Interview Topics *"}),t.length>0&&e.jsxs("div",{className:"mb-4",children:[e.jsxs("p",{className:"text-sm text-gray-600 mb-2",children:["Selected (",t.length,"):"]}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(r=>e.jsx(P.div,{initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},children:e.jsxs("button",{type:"button",onClick:()=>S(r),className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-primary-100 text-primary-800 hover:bg-primary-200 transition-colors cursor-pointer",children:[r,e.jsx("span",{className:"ml-1",children:"×"})]})},r))})]}),e.jsx("div",{className:"mb-4",children:e.jsx("input",{type:"text",placeholder:"Search skills...",value:h,onChange:r=>_(r.target.value),className:"w-full px-4 py-2 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-64 overflow-y-auto",children:j.map((r,a)=>e.jsx(P.div,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:a*.01},children:e.jsx("button",{type:"button",onClick:()=>S(r),className:"inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-gray-100 text-gray-800 hover:bg-gray-200 transition-colors cursor-pointer",children:r})},r))}),j.length===0&&h&&e.jsxs("p",{className:"text-gray-500 text-sm mt-2",children:['No skills found matching "',h,'"']})]}),e.jsxs(y,{className:"mb-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(H,{className:"h-5 w-5 mr-2"}),"Preferred Duration"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:X.map(r=>e.jsxs("button",{onClick:()=>A(r.value),className:`p-3 rounded-lg border-2 transition-all ${x===r.value?"border-primary-500 bg-primary-50 text-primary-700":"border-gray-200 hover:border-gray-300"}`,children:[e.jsxs("div",{className:"font-semibold",children:[r.value," min"]}),r.value===60&&e.jsx("div",{className:"text-xs text-gray-500",children:"Recommended"})]},r.value))})]}),e.jsxs(y,{className:"mb-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Notes (Optional)"}),e.jsx("textarea",{placeholder:"Any specific areas you want to focus on, your experience level, or other preferences...",value:w,onChange:r=>D(r.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsxs("div",{className:"flex items-center justify-between bg-white p-6 rounded-lg shadow-sm border",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[t.length," skill",t.length!==1?"s":""," selected"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Duration: ",x," minutes"]})]}),e.jsxs(G,{size:"lg",onClick:L,isLoading:N.isPending||v,disabled:t.length===0||v||n.isLoading,children:[e.jsx(J,{className:"h-5 w-5 mr-2"}),"Submit Interview Request"]})]}),e.jsxs("div",{className:"mt-6 flex items-center gap-3 text-gray-600",children:[e.jsx(V,{className:"h-5 w-5 text-green-500"}),e.jsx("p",{className:"text-sm",children:"Once submitted, matching interviewers will see your request and can claim it. You'll be notified immediately when scheduled."})]})]})})};export{fe as default};
//# sourceMappingURL=ScheduleInterviewPage-CUOhw56O.js.map
