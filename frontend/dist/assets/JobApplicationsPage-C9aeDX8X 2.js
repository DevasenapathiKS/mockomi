import{j as e,m as M}from"./ui-CYsdiTaZ.js";import{f as $,r as p,L as O}from"./vendor-08mqACR8.js";import{a as _,u as F,b as q}from"./query-XD-553fC.js";import{A as t,S as B,z as I}from"./index-CtB2e-Jf.js";import{j}from"./jobService-ts1EWQ9-.js";import{D as A,A as J}from"./DashboardLayout-p1chFnBS.js";import{B as l}from"./Button-qtzxgz-Z.js";import"./Input-BBy5sVcg.js";import{T as W}from"./Textarea-BjLH9yoL.js";import{C as H}from"./Card-L60jO2Bd.js";import{B as a}from"./Badge-BvbDkg5g.js";import{M as G}from"./Modal-DcH0rstZ.js";import{E as K}from"./EmptyState-CHHjMOaD.js";import{F as Q}from"./ArrowLeftIcon-iBAG5m-G.js";import{F as V}from"./UsersIcon-hudjBy-f.js";import{F as Y}from"./DocumentTextIcon-CLIC1k8p.js";import{F as U}from"./CheckCircleIcon-BIxcTuyz.js";import{F as X}from"./XCircleIcon-DXZ4M08a.js";import{F as Z}from"./XMarkIcon-B-SQiyPX.js";import"./useAuth-C5MDDvFB.js";import"./UserIcon-ACflAg1t.js";import"./BuildingOfficeIcon-m0Wh3_We.js";const Re=()=>{const{jobId:r}=$(),k=_(),[u,C]=p.useState("all"),[f,g]=p.useState(null),[D,c]=p.useState(!1),[y,N]=p.useState(""),{data:x}=F({queryKey:["job",r],queryFn:()=>j.getJob(r),enabled:!!r}),{data:h,isLoading:T}=F({queryKey:["job-applications",r],queryFn:()=>j.getJobApplications(r),enabled:!!r}),d=q({mutationFn:({applicationId:s,status:o,reason:n})=>j.updateApplicationStatus(s,o,n),onSuccess:()=>{I.success("Application status updated"),k.invalidateQueries({queryKey:["job-applications",r]}),c(!1),N(""),g(null)},onError:s=>{I.error(s.message||"Failed to update status")}}),L=()=>{f&&d.mutate({applicationId:f._id,status:t.REJECTED,reason:y})},z=s=>{const o=i.find(n=>n._id===s);g(o),c(!0)},i=(h==null?void 0:h.data)||[],v=u==="all"?i:i.filter(s=>s.status===u),P=s=>{switch(s){case t.PENDING:return e.jsx(a,{variant:"warning",children:"Pending"});case t.REVIEWED:return e.jsx(a,{variant:"info",children:"Reviewed"});case t.SHORTLISTED:return e.jsx(a,{variant:"success",children:"Shortlisted"});case t.INTERVIEW:return e.jsx(a,{variant:"primary",children:"Interview"});case t.OFFERED:return e.jsx(a,{variant:"success",children:"Offered"});case t.REJECTED:return e.jsx(a,{variant:"danger",children:"Rejected"});case t.WITHDRAWN:return e.jsx(a,{variant:"gray",children:"Withdrawn"});default:return e.jsx(a,{variant:"gray",children:s})}},m={all:i.length,pending:i.filter(s=>s.status===t.PENDING).length,shortlisted:i.filter(s=>s.status===t.SHORTLISTED).length};return T?e.jsx(A,{children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(B,{size:"lg"})})}):(console.log("applications",i),e.jsx(A,{children:e.jsxs("div",{className:"max-w-5xl mx-auto",children:[e.jsxs("div",{className:"mb-6",children:[e.jsxs(O,{to:"/dashboard/my-jobs",className:"inline-flex items-center text-gray-600 hover:text-gray-900 mb-4",children:[e.jsx(Q,{className:"h-4 w-4 mr-2"}),"Back to My Jobs"]}),e.jsxs("h1",{className:"text-2xl font-bold text-gray-900",children:["Applications for ",x==null?void 0:x.title]}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[m.all," total applications"]})]}),e.jsx("div",{className:"flex gap-2 mb-6",children:[{key:"all",label:"All",count:m.all},{key:"pending",label:"Pending",count:m.pending},{key:"shortlisted",label:"Shortlisted",count:m.shortlisted}].map(s=>e.jsxs("button",{onClick:()=>C(s.key),className:`px-4 py-2 rounded-lg font-medium transition-colors ${u===s.key?"bg-primary-100 text-primary-700":"bg-gray-100 text-gray-600 hover:bg-gray-200"}`,children:[s.label," (",s.count,")"]},s.key))}),v.length>0?e.jsx("div",{className:"space-y-4",children:v.map((s,o)=>{var n,R,b,S,E,w;return e.jsx(M.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:o*.05},children:e.jsxs(H,{children:[e.jsxs("div",{className:"flex flex-col md:flex-row md:items-center gap-4",children:[e.jsx(J,{src:(n=s.applicant)==null?void 0:n.avatar,name:`${(R=s.applicant)==null?void 0:R.firstName} ${(b=s.applicant)==null?void 0:b.lastName}`,size:"lg"}),e.jsxs("div",{className:"flex-1",children:[e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsxs("h3",{className:"font-semibold text-gray-900",children:[(S=s.jobSeekerId)==null?void 0:S.firstName," ",(E=s.jobSeekerId)==null?void 0:E.lastName]}),P(s.status)]}),e.jsx("p",{className:"text-sm text-gray-600",children:(w=s.applicant)==null?void 0:w.email}),e.jsxs("p",{className:"text-sm text-gray-500 mt-1",children:[e.jsx(V,{className:"h-4 w-4 inline mr-1"}),"Applied ",new Date(s.appliedAt).toLocaleDateString()]})]}),e.jsxs("div",{className:"flex items-center gap-2",children:[s.resume&&e.jsx("a",{href:s.resume,target:"_blank",rel:"noopener noreferrer",children:e.jsxs(l,{variant:"outline",size:"sm",children:[e.jsx(Y,{className:"h-4 w-4 mr-1"}),"Resume"]})}),s.status===t.PENDING&&e.jsxs(e.Fragment,{children:[e.jsxs(l,{size:"sm",onClick:()=>d.mutate({applicationId:s._id,status:t.SHORTLISTED}),children:[e.jsx(U,{className:"h-4 w-4 mr-1"}),"Shortlist"]}),e.jsxs(l,{variant:"outline",size:"sm",onClick:()=>z(s._id),children:[e.jsx(X,{className:"h-4 w-4 mr-1"}),"Reject"]})]}),s.status===t.SHORTLISTED&&e.jsx(l,{size:"sm",onClick:()=>d.mutate({applicationId:s._id,status:t.INTERVIEW}),children:"Schedule Interview"})]})]}),s.coverLetter&&e.jsxs("div",{className:"mt-4 pt-4 border-t",children:[e.jsx("h4",{className:"text-sm font-medium text-gray-900 mb-2",children:"Cover Letter"}),e.jsx("p",{className:"text-sm text-gray-600 whitespace-pre-line",children:s.coverLetter})]})]})},s._id)})}):e.jsx(K,{icon:e.jsx(Z,{className:"h-12 w-12"}),title:"No applications yet",description:"Applications will appear here once candidates apply to this job."}),e.jsx(G,{isOpen:D,onClose:()=>c(!1),title:"Reject Application",size:"md",children:e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:"Are you sure you want to reject this application? You can optionally provide a reason."}),e.jsx(W,{label:"Rejection Reason (optional)",placeholder:"Provide feedback for the candidate...",value:y,onChange:s=>N(s.target.value),rows:4}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(l,{variant:"outline",onClick:()=>c(!1),children:"Cancel"}),e.jsx(l,{variant:"danger",onClick:L,isLoading:d.isPending,children:"Reject Application"})]})]})})]})}))};export{Re as default};
//# sourceMappingURL=JobApplicationsPage-C9aeDX8X.js.map
