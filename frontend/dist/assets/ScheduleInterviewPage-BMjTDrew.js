import{j as e,m as x}from"./ui-E8jIx32d.js";import{r as a,e as ce}from"./vendor-08mqACR8.js";import{b as me,u as de,d as Y}from"./data-CNpY1-rC.js";import{h as C,i as S,u as ue,z as o}from"./index-Cjn7xYNH.js";import{i as G}from"./interviewService-BimeJGjX.js";import{D as pe}from"./DashboardLayout-C3XsTHZl.js";import{B as f}from"./Button-DkVvCag_.js";import{I as W}from"./Input-Bbjou70d.js";import"./Textarea-Da6oJh8a.js";import{C as h}from"./Card-Kk9NAdVM.js";import{F as xe}from"./InformationCircleIcon-BzNmsCGV.js";import{F as he}from"./CheckCircleIcon-DZna7A69.js";import{b as k}from"./XMarkIcon-B-SQiyPX.js";import{F as ye}from"./CurrencyRupeeIcon-qiBkUxPz.js";import{F as q}from"./CheckBadgeIcon-w73AzcaW.js";import{F as J}from"./MagnifyingGlassIcon-DUoGsubn.js";import{F as ge}from"./ClockIcon-sUFCzahK.js";import{F as fe}from"./SparklesIcon-BDp_jVkK.js";import{F as we}from"./UsersIcon-hudjBy-f.js";import{F as ve}from"./CheckCircleIcon-BIxcTuyz.js";import"./useAuth-cQdBU6Dg.js";import"./UserIcon-ACflAg1t.js";import"./BuildingOfficeIcon-m0Wh3_We.js";function be({title:i,titleId:r,...l},t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),i?a.createElement("title",{id:r},i):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M12 9v6m3-3H9m12 0a9 9 0 1 1-18 0 9 9 0 0 1 18 0Z"}))}const z=a.forwardRef(be);function je({title:i,titleId:r,...l},t){return a.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:t,"aria-labelledby":r},l),i?a.createElement("title",{id:r},i):null,a.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M16.5 6v.75m0 3v.75m0 3v.75m0 3V18m-9-5.25h5.25M7.5 15h3M3.375 5.25c-.621 0-1.125.504-1.125 1.125v3.026a2.999 2.999 0 0 1 0 5.198v3.026c0 .621.504 1.125 1.125 1.125h17.25c.621 0 1.125-.504 1.125-1.125v-3.026a2.999 2.999 0 0 1 0-5.198V6.375c0-.621-.504-1.125-1.125-1.125H3.375Z"}))}const Ne=a.forwardRef(je),Z={createOrder:async i=>{try{return(await C.post("/payments/create-order",i)).data.data}catch(r){throw new Error(S(r))}},verifyPayment:async i=>{try{return(await C.post("/payments/verify",i)).data.data}catch(r){throw new Error(S(r))}}},ke={validateCoupon:async i=>{try{return(await C.post("/coupons/validate",{couponCode:i})).data.data}catch(r){throw new Error(S(r))}},getCouponUsage:async i=>{try{return(await C.get(`/coupons/usage?couponCode=${encodeURIComponent(i)}`)).data.data}catch(r){throw new Error(S(r))}}},L=["JavaScript","TypeScript","React","Angular","Vue.js","Node.js","Python","Java","C++","Go","Rust","Ruby","System Design","Data Structures","Algorithms","Database Design","AWS","Azure","GCP","Docker","Kubernetes","DevOps","Machine Learning","Data Science","AI/ML","Frontend","Backend","Full Stack","Mobile Development","REST API","GraphQL","Microservices","SQL","MongoDB","PostgreSQL","Redis","Behavioral","HR Interview","Leadership"],Ce=[{value:30,label:"30 minutes"},{value:45,label:"45 minutes"},{value:60,label:"60 minutes"},{value:90,label:"90 minutes"}],Ge=()=>{var V;const i=ce(),r=me(),{user:l}=ue(),[t,w]=a.useState([]),[R,X]=a.useState(30),[D,ee]=a.useState(""),[m,v]=a.useState(""),[M,_]=a.useState(!1),[b,$]=a.useState(""),[d,j]=a.useState(null),[K,O]=a.useState(!1),[U,y]=a.useState(null),P=L.filter(s=>s.toLowerCase().includes(m.toLowerCase())&&!t.includes(s)),I=de({queryKey:["interview-payment-check"],queryFn:()=>G.checkPaymentRequirement()}),se=Y({mutationFn:s=>ke.validateCoupon(s),onSuccess:s=>{s.valid?(j({code:s.coupon.code,remainingUses:s.remainingUses,description:s.coupon.description}),y(null),o.success(s.message)):(j(null),y(s.message),o.error(s.message))},onError:s=>{j(null),y(s.message),o.error(s.message)}}),A=Y({mutationFn:s=>G.createInterviewRequest({requestedSkills:t,preferredDuration:R,notes:D||void 0,paymentId:s==null?void 0:s.paymentId,couponCode:s==null?void 0:s.couponCode}),onSuccess:()=>{o.success("Interview request submitted! You will be notified when an interviewer accepts."),r.invalidateQueries({queryKey:["my-interviews"]}),r.invalidateQueries({queryKey:["my-interview-requests"]}),i("/dashboard/interviews")},onError:s=>{o.error(s.message||"Failed to submit interview request")}}),te=()=>new Promise((s,n)=>{if(window.Razorpay){s();return}const c=document.createElement("script");c.src="https://checkout.razorpay.com/v1/checkout.js",c.onload=()=>s(),c.onerror=()=>n(new Error("Failed to load Razorpay SDK")),document.body.appendChild(c)}),re=async()=>{const s=I.data,n=Math.max(1e4,Math.round(((s==null?void 0:s.pricePerInterview)??100)*100)),c="rzp_test_RxlUrYIiGrG6kN",u=await Z.createOrder({amount:n,notes:{reason:"mock_interview_request"}});return await te(),new Promise((le,N)=>{if(!window.Razorpay){N(new Error("Razorpay SDK not available"));return}const H=new window.Razorpay({key:c,amount:u.amount,currency:u.currency,name:"Mockomi",description:"Mock interview booking",order_id:u.orderId,handler:async p=>{try{const g=await Z.verifyPayment({razorpay_order_id:p.razorpay_order_id,razorpay_payment_id:p.razorpay_payment_id,razorpay_signature:p.razorpay_signature});le(g._id)}catch(g){N(g)}},prefill:{name:`${(l==null?void 0:l.firstName)??""} ${(l==null?void 0:l.lastName)??""}`.trim(),email:(l==null?void 0:l.email)||""},notes:u!=null&&u.paymentId?{paymentId:u.paymentId}:void 0,theme:{color:"#0ea5e9"},modal:{ondismiss:()=>{N(new Error("Payment was cancelled. Interview request was not created."))}}});H.on("payment.failed",p=>{var g;N(new Error(((g=p==null?void 0:p.error)==null?void 0:g.description)||"Payment failed. Interview request was not created."))}),H.open()})},B=s=>{const n=s.trim();n&&(t.includes(n)?w(t.filter(c=>c!==n)):w([...t,n]))},E=()=>{const s=m.trim();if(!s){o.error("Please enter a skill name");return}if(t.includes(s)){o.error("This skill is already selected");return}w([...t,s]),v(""),o.success(`Added "${s}" as a custom skill`)},ae=()=>{w([]),v("")},Q=()=>{v("")},F=m.trim()&&!t.includes(m.trim())&&!L.map(s=>s.toLowerCase()).includes(m.trim().toLowerCase()),T=async()=>{if(!b.trim()){o.error("Please enter a coupon code");return}O(!0),y(null),await se.mutateAsync(b.trim().toUpperCase()),O(!1)},ie=()=>{j(null),$(""),y(null)},ne=async()=>{if(t.length===0){o.error("Please select at least one skill for your interview");return}if(d)try{await A.mutateAsync({couponCode:d.code})}catch{}else{let s;try{if(_(!0),s=await re(),!s)throw new Error("Payment verification failed");o.success("Payment successful! Creating interview request..."),await A.mutateAsync({paymentId:s})}catch(n){const c=(n==null?void 0:n.message)||"Payment was cancelled or failed";c.includes("cancelled")?o.error("Payment cancelled. Interview request was not created. Please try again when ready."):c.includes("failed")?o.error(c):o.error(c);return}finally{_(!1)}}},oe=!d;return e.jsx(pe,{children:e.jsxs("div",{className:"max-w-4xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Request Mock Interview"}),e.jsx("p",{className:"text-gray-600 mt-1",children:"Select the skills you want to be interviewed on. An expert interviewer will pick up your request."})]}),e.jsx(h,{className:"mb-8 bg-gradient-to-r from-blue-50 to-indigo-50 border-blue-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-blue-100 rounded-lg",children:e.jsx(xe,{className:"h-6 w-6 text-blue-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-blue-900",children:"How It Works"}),e.jsxs("ol",{className:"list-decimal list-inside text-blue-700 mt-2 space-y-1 text-sm",children:[e.jsx("li",{children:"Select the skills/topics you want to practice"}),e.jsx("li",{children:"Choose your preferred interview duration"}),e.jsx("li",{children:"Apply a coupon code or complete payment"}),e.jsx("li",{children:"Submit your request"}),e.jsx("li",{children:"An expert interviewer matching your skills will claim your request"}),e.jsx("li",{children:"You'll receive a notification with the scheduled time"})]})]})]})}),e.jsx(h,{className:"mb-8 bg-gradient-to-r from-purple-50 to-pink-50 border-purple-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-purple-100 rounded-lg",children:e.jsx(Ne,{className:"h-6 w-6 text-purple-600"})}),e.jsxs("div",{className:"flex-1",children:[e.jsx("h3",{className:"font-semibold text-purple-900 mb-3",children:"Have a Coupon Code?"}),d?e.jsx(x.div,{initial:{opacity:0,scale:.95},animate:{opacity:1,scale:1},className:"p-4 bg-white rounded-lg border-2 border-green-200 shadow-sm",children:e.jsxs("div",{className:"flex items-start justify-between",children:[e.jsxs("div",{className:"flex items-start gap-3",children:[e.jsx("div",{className:"p-2 bg-green-100 rounded-lg",children:e.jsx(he,{className:"h-5 w-5 text-green-600"})}),e.jsxs("div",{children:[e.jsx("p",{className:"font-semibold text-gray-900",children:d.code}),e.jsx("p",{className:"text-sm text-gray-600 mt-1",children:d.description}),e.jsxs("p",{className:"text-sm text-green-600 font-medium mt-2",children:[d.remainingUses," use",d.remainingUses!==1?"s":""," remaining"]})]})]}),e.jsx("button",{onClick:ie,className:"text-gray-400 hover:text-gray-600 transition-colors",children:e.jsx(k,{className:"h-5 w-5"})})]})}):e.jsxs("div",{className:"space-y-3",children:[e.jsxs("div",{className:"flex gap-2",children:[e.jsx(W,{placeholder:"Enter coupon code (e.g., INTERVIEW50)",value:b,onChange:s=>{$(s.target.value.toUpperCase()),y(null)},onKeyPress:s=>{s.key==="Enter"&&T()},className:"flex-1 uppercase"}),e.jsx(f,{onClick:T,isLoading:K,disabled:!b.trim()||K,children:"Apply"})]}),U&&e.jsx(x.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},className:"p-3 bg-red-50 border border-red-200 rounded-lg text-red-700 text-sm",children:U})]})]})]})}),oe&&e.jsx(h,{className:"mb-8 bg-primary-50 border-primary-200",children:e.jsxs("div",{className:"flex items-start gap-4",children:[e.jsx("div",{className:"p-3 bg-primary-100 rounded-lg",children:e.jsx(ye,{className:"h-6 w-6 text-primary-600"})}),e.jsxs("div",{children:[e.jsx("h3",{className:"font-semibold text-primary-900",children:"Pricing Information"}),e.jsxs("p",{className:"text-primary-700 mt-1",children:["Each interview costs â‚¹",((V=I.data)==null?void 0:V.pricePerInterview)??100,". Apply a coupon code above to get a free interview!"]})]})]})}),e.jsxs(h,{className:"mb-6 p-6",children:[e.jsxs("div",{className:"flex items-center justify-between mb-4",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900",children:"Select Interview Topics *"}),t.length>0&&e.jsxs(f,{type:"button",variant:"outline",size:"sm",onClick:ae,className:"text-gray-600",children:[e.jsx(k,{className:"h-4 w-4 mr-1"}),"Clear All"]})]}),t.length>0&&e.jsxs(x.div,{initial:{opacity:0,height:0},animate:{opacity:1,height:"auto"},exit:{opacity:0,height:0},className:"mb-6 p-4 bg-primary-50 rounded-xl border border-primary-200",children:[e.jsx("div",{className:"flex items-center justify-between mb-3",children:e.jsxs("p",{className:"text-sm font-medium text-primary-900 flex items-center gap-2",children:[e.jsx(q,{className:"h-4 w-4"}),"Selected Skills (",t.length,")"]})}),e.jsx("div",{className:"flex flex-wrap gap-2",children:t.map(s=>e.jsxs(x.button,{type:"button",initial:{scale:.8,opacity:0},animate:{scale:1,opacity:1},whileHover:{scale:1.05},onClick:()=>B(s),className:"inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-primary-600 text-white hover:bg-primary-700 transition-colors cursor-pointer shadow-sm",children:[s,e.jsx(k,{className:"h-4 w-4 ml-1.5"})]},s))})]}),e.jsxs("div",{className:"mb-4 relative",children:[e.jsxs("div",{className:"relative",children:[e.jsx(J,{className:"absolute left-3 top-1/2 transform -translate-y-1/2 h-5 w-5 text-gray-400"}),e.jsx(W,{type:"text",placeholder:"Search skills or add custom skills...",value:m,onChange:s=>v(s.target.value),onKeyPress:s=>{s.key==="Enter"&&F&&(s.preventDefault(),E())},className:"pl-10 pr-10"}),m&&e.jsxs("div",{className:"absolute right-3 top-1/2 transform -translate-y-1/2 flex items-center gap-2",children:[F&&e.jsx("button",{type:"button",onClick:E,className:"text-primary-600 hover:text-primary-700 font-medium text-sm flex items-center gap-1",title:"Add as custom skill",children:e.jsx(z,{className:"h-5 w-5"})}),e.jsx("button",{type:"button",onClick:Q,className:"text-gray-400 hover:text-gray-600",children:e.jsx(k,{className:"h-4 w-4"})})]})]}),F&&e.jsxs(x.p,{initial:{opacity:0,y:-5},animate:{opacity:1,y:0},className:"mt-2 text-sm text-primary-600 flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),'Press Enter or click + to add "',m.trim(),'" as a custom skill']})]}),P.length>0?e.jsxs("div",{className:"space-y-3",children:[e.jsxs("p",{className:"text-sm text-gray-600",children:["Available skills (",P.length,")"]}),e.jsx("div",{className:"flex flex-wrap gap-2 max-h-80 overflow-y-auto p-3 bg-gray-50 rounded-lg border border-gray-200",children:P.map((s,n)=>e.jsxs(x.button,{type:"button",initial:{opacity:0,y:10},animate:{opacity:1,y:0},transition:{delay:n*.01},onClick:()=>B(s),className:"inline-flex items-center px-3 py-1.5 rounded-full text-sm font-medium bg-white text-gray-800 hover:bg-primary-50 hover:text-primary-700 hover:border-primary-300 border border-gray-200 transition-all cursor-pointer shadow-sm",children:[s,e.jsx("span",{className:"ml-1.5 text-primary-600",children:"+"})]},s))})]}):e.jsx(x.div,{initial:{opacity:0},animate:{opacity:1},className:"text-center py-12 bg-gray-50 rounded-lg border-2 border-dashed border-gray-300",children:t.length===L.length?e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-12 w-12 mx-auto text-green-500 mb-4"}),e.jsx("p",{className:"text-gray-900 font-medium mb-1",children:"All skills selected!"}),e.jsx("p",{className:"text-sm text-gray-600",children:"You've selected all available skills. Remove some to see more options."})]}):m?e.jsxs(e.Fragment,{children:[e.jsx(J,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-900 font-medium mb-1",children:"No matching skills found"}),e.jsxs("p",{className:"text-sm text-gray-600 mb-4",children:['"',m,'" is not in our predefined list. You can add it as a custom skill!']}),e.jsxs("div",{className:"flex gap-2 justify-center",children:[e.jsxs(f,{type:"button",onClick:E,className:"flex items-center gap-2",children:[e.jsx(z,{className:"h-4 w-4"}),'Add "',m,'" as Custom Skill']}),e.jsx(f,{type:"button",variant:"outline",size:"sm",onClick:Q,children:"Clear Search"})]})]}):e.jsxs(e.Fragment,{children:[e.jsx(q,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-gray-900 font-medium mb-1",children:"No skills available"}),e.jsx("p",{className:"text-sm text-gray-600",children:"All skills have been selected. Remove some skills above to see more options."})]})})]}),e.jsxs(h,{className:"mb-6 p-6",children:[e.jsxs("h2",{className:"text-lg font-semibold text-gray-900 mb-4 flex items-center",children:[e.jsx(ge,{className:"h-5 w-5 mr-2"}),"Preferred Duration"]}),e.jsx("div",{className:"grid grid-cols-2 md:grid-cols-4 gap-3",children:Ce.map(s=>e.jsxs("button",{onClick:()=>X(s.value),className:`p-4 rounded-xl border-2 transition-all ${R===s.value?"border-primary-500 bg-primary-50 text-primary-700 shadow-md":"border-gray-200 hover:border-gray-300 bg-white"}`,children:[e.jsxs("div",{className:"font-semibold text-lg",children:[s.value," min"]}),s.value===30&&e.jsx("div",{className:"text-xs text-gray-500 mt-1",children:"Recommended"})]},s.value))})]}),e.jsxs(h,{className:"mb-6 p-6",children:[e.jsx("h2",{className:"text-lg font-semibold text-gray-900 mb-4",children:"Additional Notes (Optional)"}),e.jsx("textarea",{placeholder:"Any specific areas you want to focus on, your experience level, or other preferences...",value:D,onChange:s=>ee(s.target.value),rows:4,className:"w-full px-4 py-3 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500 focus:border-primary-500"})]}),e.jsx(h,{className:"p-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row items-center justify-between gap-4",children:[e.jsxs("div",{children:[e.jsxs("p",{className:"font-semibold text-gray-900",children:[t.length," skill",t.length!==1?"s":""," selected"]}),e.jsxs("p",{className:"text-sm text-gray-600",children:["Duration: ",R," minutes"]}),d&&e.jsxs("p",{className:"text-sm text-green-600 font-medium mt-1 flex items-center gap-1",children:[e.jsx(fe,{className:"h-4 w-4"}),"Coupon applied: ",d.code]})]}),e.jsxs(f,{size:"lg",onClick:ne,isLoading:A.isPending||M,disabled:t.length===0||M||I.isLoading,children:[e.jsx(we,{className:"h-5 w-5 mr-2"}),d?"Submit Interview Request (Free)":"Submit Interview Request"]})]})}),e.jsxs("div",{className:"mt-6 flex items-center gap-3 text-gray-600 bg-green-50 p-4 rounded-lg border border-green-200",children:[e.jsx(ve,{className:"h-5 w-5 text-green-500 flex-shrink-0"}),e.jsx("p",{className:"text-sm",children:"Once submitted, matching interviewers will see your request and can claim it. You'll be notified immediately when scheduled."})]})]})})};export{Ge as default};
