{"version":3,"file":"interviewService-B10jMYsL.js","sources":["../../src/services/interviewService.ts"],"sourcesContent":["import api, { handleApiError } from './api';\nimport { Interview, InterviewType, InterviewerProfile, ApiResponse, PaginatedResponse, Payment, PaymentEligibility } from '@/types';\n\nexport interface ScheduleInterviewData {\n  interviewerId: string;\n  scheduledAt: string;\n  duration: number;\n  type: InterviewType;\n  topics?: string[];\n  notes?: string;\n}\n\n// New interface for creating interview requests (job seeker selects skills only)\nexport interface CreateInterviewRequestData {\n  requestedSkills: string[];\n  preferredDuration?: number;\n  notes?: string;\n  paymentId?: string;\n}\n\n// New interface for claiming an interview (interviewer sets schedule)\nexport interface ClaimInterviewData {\n  scheduledAt: string;\n  duration?: number;\n}\n\nexport interface InterviewFeedbackData {\n  overallRating: number;\n  technicalSkills?: number;\n  communicationSkills?: number;\n  problemSolving?: number;\n  strengths?: string;\n  areasOfImprovement?: string;\n  recommendation?: string;\n}\n\nexport const interviewService = {\n  // Get available interviewers\n  getInterviewers: async (\n    type?: InterviewType,\n    page = 1,\n    limit = 10\n  ): Promise<PaginatedResponse<InterviewerProfile & { user: { firstName: string; lastName: string; avatar?: string } }>> => {\n    try {\n      const params = new URLSearchParams({\n        page: String(page),\n        limit: String(limit),\n      });\n      if (type) params.append('type', type);\n\n      const response = await api.get<PaginatedResponse<InterviewerProfile & { user: { firstName: string; lastName: string; avatar?: string } }>>(\n        `/interviews/interviewers?${params.toString()}`\n      );\n      return response.data;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Check if payment is required\n  checkPaymentRequirement: async (): Promise<PaymentEligibility> => {\n    try {\n      const response = await api.get<ApiResponse<PaymentEligibility>>('/interviews/payment-check');\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Schedule interview\n  scheduleInterview: async (data: ScheduleInterviewData): Promise<Interview> => {\n    try {\n      const response = await api.post<ApiResponse<Interview>>('/interviews', data);\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Get my interviews\n  getMyInterviews: async (\n    status?: string,\n    page = 10,\n    limit = 100\n  ): Promise<PaginatedResponse<Interview>> => {\n    try {\n      const params = new URLSearchParams({\n        page: String(page),\n        limit: String(limit),\n      });\n      if (status) params.append('status', status);\n\n      const response = await api.get<PaginatedResponse<Interview>>(\n        `/interviews/my-interviews?${params.toString()}`\n      );\n      return response.data;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Get interview details\n  getInterview: async (id: string): Promise<Interview> => {\n    try {\n      const response = await api.get<ApiResponse<Interview>>(`/interviews/${id}`);\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Start interview (interviewer only)\n  startInterview: async (id: string): Promise<Interview> => {\n    try {\n      const response = await api.post<ApiResponse<Interview>>(`/interviews/${id}/start`);\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Complete interview (interviewer only)\n  completeInterview: async (id: string): Promise<Interview> => {\n    try {\n      const response = await api.post<ApiResponse<Interview>>(`/interviews/${id}/complete`);\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Cancel interview\n  cancelInterview: async (id: string, reason?: string): Promise<Interview> => {\n    try {\n      const response = await api.post<ApiResponse<Interview>>(`/interviews/${id}/cancel`, { reason });\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Submit feedback (interviewer only)\n  submitFeedback: async (id: string, feedback: InterviewFeedbackData): Promise<Interview> => {\n    try {\n      const response = await api.post<ApiResponse<Interview>>(`/interviews/${id}/feedback`, feedback);\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Upload recording (interviewer only)\n  uploadRecording: async (id: string, file: File): Promise<Interview> => {\n    try {\n      const formData = new FormData();\n      formData.append('recording', file);\n\n      const response = await api.post<ApiResponse<Interview>>(`/interviews/${id}/recording`, formData, {\n        headers: {\n          'Content-Type': 'multipart/form-data',\n        },\n      });\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Get recording URL\n  getRecordingUrl: async (id: string): Promise<string> => {\n    try {\n      const response = await api.get<ApiResponse<{ url: string }>>(`/interviews/${id}/recording-url`);\n      return response.data.data!.url;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Create payment order\n  createPaymentOrder: async (interviewId: string): Promise<{\n    orderId: string;\n    amount: number;\n    currency: string;\n  }> => {\n    try {\n      const response = await api.post<ApiResponse<{ orderId: string; amount: number; currency: string }>>(\n        '/interviews/payment/create-order',\n        { interviewId }\n      );\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Verify payment\n  verifyPayment: async (data: {\n    razorpayOrderId: string;\n    razorpayPaymentId: string;\n    razorpaySignature: string;\n  }): Promise<Payment> => {\n    try {\n      const response = await api.post<ApiResponse<Payment>>('/interviews/payment/verify', data);\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Get interviewer earnings\n  getInterviewerEarnings: async (params: { period?: string }): Promise<{\n    earnings: Array<{\n      id: string;\n      interviewId: string;\n      candidateName: string;\n      date: string;\n      duration: number;\n      amount: number;\n      status: 'pending' | 'paid' | 'processing';\n      type: string;\n    }>;\n    stats: {\n      totalEarnings: number;\n      pendingAmount: number;\n      paidAmount: number;\n      totalInterviews: number;\n    };\n  }> => {\n    try {\n      const queryParams = new URLSearchParams();\n      if (params.period) queryParams.append('period', params.period);\n\n      const response = await api.get(`/interviews/earnings?${queryParams.toString()}`);\n      return response.data.data || response.data;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // ==================== NEW INTERVIEW REQUEST/CLAIM FLOW ====================\n\n  // Create interview request (job seeker selects skills only)\n  createInterviewRequest: async (data: CreateInterviewRequestData): Promise<Interview> => {\n    try {\n      const response = await api.post<ApiResponse<Interview>>('/interviews/request', data);\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Get my interview requests (job seeker - pending/expired)\n  getMyInterviewRequests: async (\n    page = 1,\n    limit = 10\n  ): Promise<PaginatedResponse<Interview>> => {\n    try {\n      const params = new URLSearchParams({\n        page: String(page),\n        limit: String(limit),\n      });\n\n      const response = await api.get<PaginatedResponse<Interview>>(\n        `/interviews/my-requests?${params.toString()}`\n      );\n      return response.data;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Get available interview requests (interviewer - matching expertise)\n  getAvailableRequests: async (\n    page = 1,\n    limit = 10\n  ): Promise<PaginatedResponse<Interview>> => {\n    try {\n      const params = new URLSearchParams({\n        page: String(page),\n        limit: String(limit),\n      });\n\n      const response = await api.get<PaginatedResponse<Interview>>(\n        `/interviews/available-requests?${params.toString()}`\n      );\n      return response.data;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n\n  // Claim an interview request (interviewer sets schedule)\n  claimInterview: async (id: string, data: ClaimInterviewData): Promise<Interview> => {\n    try {\n      const response = await api.post<ApiResponse<Interview>>(`/interviews/${id}/claim`, data);\n      return response.data.data!;\n    } catch (error) {\n      throw new Error(handleApiError(error as Parameters<typeof handleApiError>[0]));\n    }\n  },\n};\n"],"names":["interviewService","type","page","limit","params","api","error","handleApiError","data","status","id","reason","feedback","file","formData","interviewId","queryParams","response"],"mappings":"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"}