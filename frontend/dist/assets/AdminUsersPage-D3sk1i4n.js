import{j as e,m as D}from"./ui-CYsdiTaZ.js";import{r as i}from"./vendor-08mqACR8.js";import{b as B,u as E,d as S}from"./data-BB-WZl-K.js";import{S as M,z as h,h as y}from"./index-CIszBDTW.js";import{D as k,A as C}from"./DashboardLayout-DyH2yYCL.js";import{B as r}from"./Button-qtzxgz-Z.js";import{I as P}from"./Input-BBy5sVcg.js";import"./Textarea-BjLH9yoL.js";import{C as F}from"./Card-L60jO2Bd.js";import{B as c}from"./Badge-BvbDkg5g.js";import{M as v}from"./Modal-DcH0rstZ.js";import{F as I}from"./MagnifyingGlassIcon-DUoGsubn.js";import{F as _}from"./UserIcon-ACflAg1t.js";import{F as U}from"./CheckCircleIcon-BIxcTuyz.js";import{F as q}from"./EyeIcon-Bn7EARGA.js";import{F as V}from"./TrashIcon-DbF6K8lY.js";import"./useAuth-C9mmUWWt.js";import"./XMarkIcon-B-SQiyPX.js";import"./UsersIcon-hudjBy-f.js";import"./BuildingOfficeIcon-m0Wh3_We.js";function J({title:m,titleId:l,...g},o){return i.createElement("svg",Object.assign({xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",strokeWidth:1.5,stroke:"currentColor","aria-hidden":"true","data-slot":"icon",ref:o,"aria-labelledby":l},g),m?i.createElement("title",{id:l},m):null,i.createElement("path",{strokeLinecap:"round",strokeLinejoin:"round",d:"M18.364 18.364A9 9 0 0 0 5.636 5.636m12.728 12.728A9 9 0 0 1 5.636 5.636m12.728 12.728L5.636 5.636"}))}const O=i.forwardRef(J),xe=()=>{const m=B(),[l,g]=i.useState(""),[o,$]=i.useState("all"),[p,L]=i.useState("all"),[n,N]=i.useState(1),[a,j]=i.useState(null),[f,t]=i.useState(null),{data:d,isLoading:z}=E({queryKey:["admin-users",{search:l,roleFilter:o,statusFilter:p,page:n}],queryFn:async()=>{const s=new URLSearchParams;return l&&s.append("search",l),o!=="all"&&s.append("role",o),p!=="all"&&s.append("status",p),s.append("page",n.toString()),s.append("limit","20"),(await y.get(`/admin/users?${s.toString()}`)).data}}),w=S({mutationFn:async({userId:s,isActive:x})=>(await y.patch(`/admin/users/${s}/status`,{isActive:x})).data,onSuccess:()=>{m.invalidateQueries({queryKey:["admin-users"]}),h.success("User status updated"),t(null)},onError:()=>{h.error("Failed to update user status")}}),b=S({mutationFn:async s=>(await y.delete(`/admin/users/${s}`)).data,onSuccess:()=>{m.invalidateQueries({queryKey:["admin-users"]}),h.success("User deleted"),t(null)},onError:()=>{h.error("Failed to delete user")}}),A=(d==null?void 0:d.users)||[],u=(d==null?void 0:d.pagination)||{total:0,pages:1},R=s=>{switch(s){case"admin":return e.jsx(c,{className:"bg-red-100 text-red-700",children:"Admin"});case"employer":return e.jsx(c,{className:"bg-blue-100 text-blue-700",children:"Employer"});case"interviewer":return e.jsx(c,{className:"bg-purple-100 text-purple-700",children:"Interviewer"});case"job_seeker":return e.jsx(c,{className:"bg-green-100 text-green-700",children:"Job Seeker"});default:return e.jsx(c,{children:s})}};return z?e.jsx(k,{children:e.jsx("div",{className:"flex justify-center items-center h-64",children:e.jsx(M,{size:"lg"})})}):e.jsx(k,{children:e.jsxs("div",{className:"max-w-7xl mx-auto",children:[e.jsxs("div",{className:"mb-8",children:[e.jsx("h1",{className:"text-2xl font-bold text-gray-900",children:"Manage Users"}),e.jsxs("p",{className:"text-gray-600 mt-1",children:[u.total," total users"]})]}),e.jsx(F,{className:"mb-6",children:e.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[e.jsxs("div",{className:"flex-1 relative",children:[e.jsx(I,{className:"h-5 w-5 absolute left-3 top-1/2 -translate-y-1/2 text-gray-400"}),e.jsx(P,{placeholder:"Search by name or email...",value:l,onChange:s=>g(s.target.value),className:"pl-10"})]}),e.jsxs("select",{value:o,onChange:s=>$(s.target.value),className:"w-40 px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:"All Roles"}),e.jsx("option",{value:"job_seeker",children:"Job Seekers"}),e.jsx("option",{value:"employer",children:"Employers"}),e.jsx("option",{value:"interviewer",children:"Interviewers"}),e.jsx("option",{value:"admin",children:"Admins"})]}),e.jsxs("select",{value:p,onChange:s=>L(s.target.value),className:"w-40 px-4 py-2.5 border border-gray-300 rounded-lg focus:ring-2 focus:ring-primary-500",children:[e.jsx("option",{value:"all",children:"All Status"}),e.jsx("option",{value:"active",children:"Active"}),e.jsx("option",{value:"inactive",children:"Inactive"}),e.jsx("option",{value:"verified",children:"Verified"}),e.jsx("option",{value:"unverified",children:"Unverified"})]})]})}),e.jsxs(F,{children:[e.jsx("div",{className:"overflow-x-auto",children:e.jsxs("table",{className:"min-w-full divide-y divide-gray-200",children:[e.jsx("thead",{className:"bg-gray-50",children:e.jsxs("tr",{children:[e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"User"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Role"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Status"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Joined"}),e.jsx("th",{className:"px-6 py-3 text-left text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Last Login"}),e.jsx("th",{className:"px-6 py-3 text-right text-xs font-medium text-gray-500 uppercase tracking-wider",children:"Actions"})]})}),e.jsx("tbody",{className:"bg-white divide-y divide-gray-200",children:A.length===0?e.jsx("tr",{children:e.jsxs("td",{colSpan:6,className:"px-6 py-12 text-center text-gray-500",children:[e.jsx(_,{className:"h-12 w-12 mx-auto text-gray-400 mb-4"}),e.jsx("p",{className:"text-lg font-medium",children:"No users found"})]})}):A.map((s,x)=>e.jsxs(D.tr,{initial:{opacity:0},animate:{opacity:1},transition:{delay:x*.03},children:[e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center",children:[e.jsx(C,{src:s.avatar,alt:`${s.firstName} ${s.lastName}`,size:"sm"}),e.jsxs("div",{className:"ml-3",children:[e.jsxs("p",{className:"font-medium text-gray-900",children:[s.firstName," ",s.lastName]}),e.jsx("p",{className:"text-sm text-gray-500",children:s.email})]})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:R(s.role)}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap",children:e.jsxs("div",{className:"flex items-center gap-2",children:[s.isActive?e.jsx(c,{variant:"success",children:"Active"}):e.jsx(c,{variant:"danger",children:"Banned"}),s.isVerified&&e.jsx(U,{className:"h-4 w-4 text-blue-500",title:"Verified"})]})}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:new Date(s.createdAt).toLocaleDateString()}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-sm text-gray-600",children:s.lastLogin?new Date(s.lastLogin).toLocaleDateString():"Never"}),e.jsx("td",{className:"px-6 py-4 whitespace-nowrap text-right",children:e.jsxs("div",{className:"flex justify-end gap-2",children:[e.jsx(r,{variant:"outline",size:"sm",onClick:()=>{j(s),t("view")},children:e.jsx(q,{className:"h-4 w-4"})}),e.jsx(r,{variant:"outline",size:"sm",onClick:()=>{j(s),t("ban")},className:s.isActive?"text-orange-600":"text-green-600",children:s.isActive?e.jsx(O,{className:"h-4 w-4"}):e.jsx(U,{className:"h-4 w-4"})}),s.role!=="admin"&&e.jsx(r,{variant:"outline",size:"sm",className:"text-red-600",onClick:()=>{j(s),t("delete")},children:e.jsx(V,{className:"h-4 w-4"})})]})})]},s._id))})]})}),u.pages>1&&e.jsxs("div",{className:"flex justify-center gap-2 mt-6",children:[e.jsx(r,{variant:"outline",size:"sm",disabled:n===1,onClick:()=>N(n-1),children:"Previous"}),e.jsxs("span",{className:"flex items-center px-4 text-sm text-gray-600",children:["Page ",n," of ",u.pages]}),e.jsx(r,{variant:"outline",size:"sm",disabled:n===u.pages,onClick:()=>N(n+1),children:"Next"})]})]}),e.jsx(v,{isOpen:f==="view"&&!!a,onClose:()=>t(null),title:"User Details",size:"lg",children:a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("div",{className:"flex items-center gap-4",children:[e.jsx(C,{src:a.avatar,alt:`${a.firstName} ${a.lastName}`,size:"lg"}),e.jsxs("div",{children:[e.jsxs("h3",{className:"text-lg font-semibold",children:[a.firstName," ",a.lastName]}),e.jsx("p",{className:"text-gray-600",children:a.email})]})]}),e.jsxs("div",{className:"grid grid-cols-2 gap-4",children:[e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Role"}),e.jsx("p",{className:"text-gray-900 capitalize",children:a.role.replace("_"," ")})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Status"}),e.jsx("p",{className:"text-gray-900",children:a.isActive?"Active":"Banned"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Verified"}),e.jsx("p",{className:"text-gray-900",children:a.isVerified?"Yes":"No"})]}),e.jsxs("div",{children:[e.jsx("p",{className:"text-sm font-medium text-gray-500",children:"Joined"}),e.jsx("p",{className:"text-gray-900",children:new Date(a.createdAt).toLocaleDateString()})]})]})]})}),e.jsx(v,{isOpen:f==="ban"&&!!a,onClose:()=>t(null),title:a!=null&&a.isActive?"Ban User":"Unban User",size:"sm",children:a&&e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-600",children:a.isActive?`Are you sure you want to ban ${a.firstName} ${a.lastName}? They will not be able to access their account.`:`Are you sure you want to unban ${a.firstName} ${a.lastName}?`}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(r,{variant:"outline",onClick:()=>t(null),children:"Cancel"}),e.jsx(r,{className:a.isActive?"bg-orange-600 hover:bg-orange-700":"",onClick:()=>w.mutate({userId:a._id,isActive:!a.isActive}),isLoading:w.isPending,children:a.isActive?"Ban User":"Unban User"})]})]})}),e.jsx(v,{isOpen:f==="delete"&&!!a,onClose:()=>t(null),title:"Delete User",size:"sm",children:a&&e.jsxs("div",{className:"space-y-4",children:[e.jsxs("p",{className:"text-gray-600",children:["Are you sure you want to permanently delete ",a.firstName," ",a.lastName,"'s account? This action cannot be undone."]}),e.jsxs("div",{className:"flex justify-end gap-3",children:[e.jsx(r,{variant:"outline",onClick:()=>t(null),children:"Cancel"}),e.jsx(r,{className:"bg-red-600 hover:bg-red-700",onClick:()=>b.mutate(a._id),isLoading:b.isPending,children:"Delete User"})]})]})})]})})};export{xe as default};
